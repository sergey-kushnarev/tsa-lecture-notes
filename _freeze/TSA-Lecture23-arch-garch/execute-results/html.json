{
  "hash": "a5b42721f28498de52f6157dd5f7af50",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"439/639: ARCH and GARCH Models\"\nauthor: \"Dr Sergey Kushnarev\"\nformat:\n  html:\n    toc: true\n    number-sections: true\n    code-fold: true\n---\n\n\n\n\n# ARCH models\n\nARCH (Autoregressive Conditional Heteroskedasticity) models are used to model time series data with changing variance over time. They are particularly useful in financial applications where volatility is not constant. The basic idea is to model the variance of the error term as a function of past squared errors.\n\nFor comparison, the ARMA models are conditionally homoscedastic, meaning that the variance of the error term is constant over time. In contrast, ARCH models allow for the variance to change over time, which is more realistic for many financial time series.\nThe ARCH model was introduced by Robert Engle in 1982. The basic ARCH(q) model can be expressed as:\n\n$$\nY_t = \\mu + \\sigma^2_t\\epsilon_t\n$$\n\nwhere $\\epsilon_t$ is the error term, and it is assumed to be normally distributed with mean 0 and variance 1. The variance $\\sigma^2_t$ is modeled as a function of past squared errors:\n\n$$\n\\sigma^2_t = \\alpha_0 + \\alpha_1 \\epsilon^2_{t-1} + \\alpha_2 \\epsilon^2_{t-2} + ... + \\alpha_q \\epsilon^2_{t-q}\n$$\n\nwhere $\\alpha_0 > 0$ and $\\alpha_i \\geq 0$ for $i=1,2,...,q$. The parameters $\\alpha_0, \\alpha_1, ..., \\alpha_q$ are estimated from the data.\n\nFor example, ARCH(1) can be expressed as:\n$$\nY_t = \\mu + \\sigma^2_t\\epsilon_t \n$$\n\n$$\n\\sigma^2_t = \\alpha_0 + \\alpha_1 \\epsilon^2_{t-1}\n$$\n\nwhere $\\alpha_0 > 0$ and $\\alpha_1 \\geq 0$. The ARCH(1) model captures the idea that the current variance is a function of the previous squared error.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(TSA)\n# Load the CREF data\ndata(CREF) \nplot(CREF)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the returns\nr.cref <- diff(log(CREF))*100\nplot(r.cref) \nabline(h=0)\ntitle(main=\"CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot ACF and PACF\nacf(r.cref, main=\"ACF of CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(r.cref, main=\"PACF of CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot ACF and PACF of absolute returns\nacf(abs(r.cref))\ntitle(main=\"ACF of Absolute CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(abs(r.cref))\ntitle(main=\"PACF of Absolute CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot ACF and PACF of squared returns\nacf(r.cref^2, main=\"ACF of Squared CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(r.cref^2, main=\"PACF of Squared CREF Returns\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-3-6.png){width=672}\n:::\n:::\n\n\n\n\nNote, that the ACF and PACF of the squared returns show significant spikes, indicating the presence of ARCH effects, but ACF and PACF of the original returns shows white noise.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform McLeod-Li test for ARCH effects\nMcLeod.Li.test(y=r.cref)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(r.cref)\nqqline(r.cref)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(r.cref)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  r.cref\nW = 0.99324, p-value = 0.02412\n```\n\n\n:::\n:::\n\n\n\n\n# Simulated ARCH(1) process\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1235678); library(tseries)\ngarch01.sim=garch.sim(alpha=c(.01,.9),n=500)\nplot(garch01.sim,type='l',ylab=expression(r[t]), xlab='t')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234567)\ngarch11.sim=garch.sim(alpha=c(0.02,0.05),beta=.9,n=500)\nplot(garch11.sim,type='l',ylab=expression(r[t]), xlab='t')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# ACF and PACF of the simulated ARCH(1) process\nacf(garch11.sim, main=\"ACF of Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(garch11.sim, main=\"PACF of Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# ACF and PACF of the absolute values of the simulated ARCH(1) process\nacf(abs(garch11.sim), main=\"ACF of Absolute Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(abs(garch11.sim), main=\"PACF of Absolute Simulated ARCH(1) Process\")\ntitle(main=\"PACF of Absolute Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# ACF and PACF of the squared values of the simulated ARCH(1) process\nacf(garch11.sim^2, main=\"ACF of Squared Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(garch11.sim^2, main=\"PACF of Squared Simulated ARCH(1) Process\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# Extended ACF of squared and absolute values\neacf((garch11.sim)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAR/MA\n  0 1 2 3 4 5 6 7 8 9 10 11 12 13\n0 o o x x o o x o o o o  o  o  o \n1 x o o o x o x x o o o  o  o  o \n2 x o o o o o x o o o o  o  o  o \n3 x x x o o x o o o o o  o  o  o \n4 x x o x x o o o o o o  o  o  o \n5 x o x x o o o o o o o  o  o  o \n6 x o x x o x o o o o o  o  o  o \n7 x x x x x x o o o o o  o  o  o \n```\n\n\n:::\n\n```{.r .cell-code}\neacf(abs(garch11.sim))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAR/MA\n  0 1 2 3 4 5 6 7 8 9 10 11 12 13\n0 o o x x o o x o o o o  o  o  o \n1 x o o o x o o o o o o  o  o  o \n2 x x o o o o o o o o o  o  o  o \n3 x x o o o x o o o o o  o  o  o \n4 x x o x o x o o o o o  o  o  o \n5 x o x x x o o o o o o  o  o  o \n6 x o x x x x o o o o o  o  o  o \n7 x x x x x o x o o o o  o  o  o \n```\n\n\n:::\n:::\n\n\n\n\nPlotting Extended ACF for the absolute and squared returns of the CREF data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\neacf(abs(r.cref))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAR/MA\n  0 1 2 3 4 5 6 7 8 9 10 11 12 13\n0 o o o o o o o o o x x  o  o  o \n1 x o o o o o o o o o o  o  o  o \n2 x o o o o o o o o o o  o  o  o \n3 x o x o o o o o o o o  o  o  o \n4 x o x o o o o o o o o  o  o  o \n5 x x x x o o o o o o o  o  o  o \n6 x x x x o o o o o o o  o  o  o \n7 x x x x o o o o o o o  o  o  o \n```\n\n\n:::\n\n```{.r .cell-code}\neacf((r.cref)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAR/MA\n  0 1 2 3 4 5 6 7 8 9 10 11 12 13\n0 o o x x o o o x o x o  x  x  o \n1 x o o o o o o x o x o  o  x  o \n2 x x o o o o o o o o o  o  o  o \n3 x x o x o o o o o o o  x  o  o \n4 o x x x o o o o o o o  x  x  o \n5 x x o x o o o o o o o  x  o  o \n6 x x o x x o o o o o o  o  x  o \n7 x x o x o o x o o o o  o  x  o \n```\n\n\n:::\n:::\n\n\n\n\n## Fitting ARIMA and GARCH models to simulated GARCH(1,1)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\narima(abs(garch11.sim),order=c(1,0,1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\narima(x = abs(garch11.sim), order = c(1, 0, 1))\n\nCoefficients:\n         ar1      ma1  intercept\n      0.9821  -0.9445     0.5077\ns.e.  0.0134   0.0220     0.0499\n\nsigma^2 estimated as 0.1486:  log likelihood = -232.97,  aic = 471.94\n```\n\n\n:::\n\n```{.r .cell-code}\ng1 <- garch(garch11.sim,order=c(2,2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n ***** ESTIMATION WITH ANALYTICAL GRADIENT ***** \n\n     I     INITIAL X(I)        D(I)\n\n     1     3.294364e-01     1.000e+00\n     2     5.000000e-02     1.000e+00\n     3     5.000000e-02     1.000e+00\n     4     5.000000e-02     1.000e+00\n     5     5.000000e-02     1.000e+00\n\n    IT   NF      F         RELDF    PRELDF    RELDX   STPPAR   D*STEP   NPRELDF\n     0    1  2.661e+01\n     1    4  2.641e+01  7.54e-03  1.69e-02  3.7e-02  5.1e+02  3.0e-02  4.31e+00\n     2    5  2.609e+01  1.21e-02  1.87e-02  4.3e-02  2.0e+00  3.0e-02  1.50e+01\n     3    6  2.573e+01  1.40e-02  1.46e-02  3.3e-02  2.0e+00  3.0e-02  6.06e+00\n     4    9  2.279e+01  1.14e-01  1.06e-01  3.4e-01  1.8e+00  2.4e-01  6.46e+00\n     5   11  2.225e+01  2.39e-02  2.80e-02  6.9e-02  2.0e+00  4.7e-02  2.82e+02\n     6   12  2.157e+01  3.03e-02  3.31e-02  5.4e-02  2.0e+00  4.7e-02  3.50e+02\n     7   13  2.111e+01  2.17e-02  2.66e-02  5.4e-02  2.0e+00  4.7e-02  1.76e+02\n     8   15  2.105e+01  2.88e-03  1.23e-02  1.9e-02  2.0e+00  1.7e-02  3.37e+01\n     9   16  2.080e+01  1.15e-02  1.42e-02  2.0e-02  2.0e+00  1.7e-02  5.77e+00\n    10   17  2.056e+01  1.15e-02  2.28e-02  4.4e-02  2.0e+00  3.5e-02  4.10e+00\n    11   20  2.052e+01  1.88e-03  3.51e-03  2.3e-03  6.1e+00  2.7e-03  1.16e+01\n    12   21  2.049e+01  1.79e-03  1.79e-03  2.5e-03  2.2e+00  2.7e-03  1.86e+01\n    13   22  2.042e+01  3.35e-03  3.41e-03  6.1e-03  2.0e+00  5.4e-03  1.91e+01\n    14   25  2.002e+01  1.98e-02  2.64e-02  5.0e-02  2.0e+00  5.4e-02  1.85e+01\n    15   29  1.997e+01  2.07e-03  3.54e-03  1.8e-03  4.2e+00  2.0e-03  8.73e-01\n    16   30  1.994e+01  1.59e-03  1.61e-03  2.1e-03  2.7e+00  2.0e-03  5.52e-01\n    17   31  1.989e+01  2.73e-03  2.79e-03  3.8e-03  2.0e+00  4.0e-03  5.91e-01\n    18   34  1.958e+01  1.53e-02  2.11e-02  3.6e-02  1.9e+00  3.7e-02  5.99e-01\n    19   35  1.930e+01  1.45e-02  2.02e-02  3.3e-02  1.9e+00  3.7e-02  6.31e-01\n    20   36  1.907e+01  1.21e-02  3.55e-02  2.9e-02  1.8e+00  3.7e-02  3.27e-01\n    21   37  1.865e+01  2.17e-02  3.50e-02  2.5e-02  1.9e+00  3.7e-02  4.75e-01\n    22   39  1.857e+01  4.21e-03  5.14e-03  2.5e-03  2.0e+00  3.7e-03  1.23e-01\n    23   42  1.847e+01  5.60e-03  5.64e-03  7.2e-03  1.6e+00  9.6e-03  1.21e-01\n    24   44  1.826e+01  1.13e-02  1.17e-02  1.7e-02  1.3e+00  1.9e-02  1.66e-01\n    25   47  1.825e+01  3.99e-04  4.53e-04  2.1e-04  2.9e+00  3.8e-04  2.11e-01\n    26   51  1.808e+01  9.32e-03  1.40e-02  1.3e-02  3.3e+00  2.3e-02  2.30e-01\n    27   53  1.803e+01  2.97e-03  5.38e-03  3.1e-03  2.0e+00  4.6e-03  1.77e-01\n    28   54  1.798e+01  2.94e-03  3.01e-03  4.0e-03  2.0e+00  4.6e-03  1.72e-01\n    29   56  1.797e+01  6.34e-04  6.77e-04  7.7e-04  2.2e+00  9.2e-04  1.66e-01\n    30   57  1.795e+01  1.10e-03  1.12e-03  1.6e-03  2.0e+00  1.8e-03  1.62e-01\n    31   59  1.792e+01  1.49e-03  1.59e-03  3.0e-03  2.0e+00  3.7e-03  1.58e-01\n    32   61  1.791e+01  5.48e-04  5.63e-04  6.0e-04  2.0e+00  7.3e-04  1.30e-01\n    33   62  1.790e+01  6.99e-04  7.34e-04  1.1e-03  2.0e+00  1.5e-03  1.22e-01\n    34   64  1.789e+01  2.65e-04  2.50e-04  2.3e-04  2.3e+00  2.9e-04  1.18e-01\n    35   66  1.789e+01  5.43e-05  5.50e-05  5.2e-05  1.5e+01  5.9e-05  1.17e-01\n    36   68  1.789e+01  1.03e-04  1.03e-04  1.0e-04  4.4e+00  1.2e-04  1.19e-01\n    37   70  1.789e+01  2.08e-05  2.03e-05  2.0e-05  4.4e+02  2.3e-05  1.19e-01\n    38   72  1.789e+01  4.14e-05  4.05e-05  4.1e-05  4.7e+01  4.7e-05  1.28e-01\n    39   74  1.789e+01  8.27e-06  8.07e-06  8.1e-06  9.6e+02  9.4e-06  1.28e-01\n    40   76  1.789e+01  1.65e-06  1.61e-06  1.6e-06  4.8e+03  1.9e-06  1.30e-01\n    41   78  1.789e+01  3.30e-07  3.23e-07  3.3e-07  2.4e+04  3.8e-07  1.30e-01\n    42   80  1.789e+01  6.61e-07  6.45e-07  6.5e-07  3.0e+03  7.5e-07  1.30e-01\n    43   82  1.789e+01  1.32e-07  1.29e-07  1.3e-07  6.0e+04  1.5e-07  1.30e-01\n    44   84  1.789e+01  2.64e-07  2.58e-07  2.6e-07  7.6e+03  3.0e-07  1.30e-01\n    45   86  1.789e+01  5.29e-07  5.16e-07  5.2e-07  3.8e+03  6.0e-07  1.30e-01\n    46   88  1.789e+01  1.06e-07  1.03e-07  1.0e-07  7.6e+04  1.2e-07  1.30e-01\n    47   90  1.789e+01  2.11e-08  2.06e-08  2.1e-08  3.8e+05  2.4e-08  1.30e-01\n    48   92  1.789e+01  4.23e-08  4.13e-08  4.2e-08  4.7e+04  4.8e-08  1.30e-01\n    49   94  1.789e+01  8.46e-09  8.26e-09  8.3e-09  9.4e+05  9.6e-09  1.30e-01\n    50   96  1.789e+01  1.69e-08  1.65e-08  1.7e-08  1.2e+05  1.9e-08  1.30e-01\n    51   98  1.789e+01  3.38e-09  3.30e-09  3.3e-09  2.4e+06  3.8e-09  1.30e-01\n    52  100  1.789e+01  6.77e-10  6.61e-10  6.7e-10  1.2e+07  7.7e-10  1.30e-01\n    53  102  1.789e+01  1.35e-09  1.32e-09  1.3e-09  1.5e+06  1.5e-09  1.30e-01\n    54  104  1.789e+01  2.71e-10  2.64e-10  2.7e-10  3.0e+07  3.1e-10  1.30e-01\n    55  106  1.789e+01  5.41e-10  5.28e-10  5.3e-10  3.7e+06  6.2e-10  1.30e-01\n    56  108  1.789e+01  1.08e-10  1.06e-10  1.1e-10  7.4e+07  1.2e-10  1.30e-01\n    57  111  1.789e+01  8.66e-10  8.46e-10  8.5e-10  2.3e+06  9.9e-10  1.30e-01\n    58  114  1.789e+01  1.73e-11  1.69e-11  1.7e-11  4.6e+08  2.0e-11  1.30e-01\n    59  116  1.789e+01  3.46e-11  3.38e-11  3.4e-11  5.8e+07  3.9e-11  1.30e-01\n    60  119  1.789e+01  6.91e-13  6.76e-13  6.8e-13  1.2e+10  7.9e-13  1.30e-01\n    61  121  1.789e+01  1.39e-12  1.35e-12  1.4e-12  1.4e+09  1.6e-12  1.30e-01\n    62  123  1.789e+01  2.75e-13  2.71e-13  2.7e-13  2.9e+10  3.2e-13  1.30e-01\n    63  125  1.789e+01  5.34e-14  5.41e-14  5.5e-14  1.4e+11  6.3e-14  1.30e-01\n    64  127  1.789e+01  1.12e-13  1.08e-13  1.1e-13  1.8e+10  1.3e-13  1.30e-01\n    65  129  1.789e+01  2.03e-14  2.16e-14  2.2e-14  3.6e+11  2.5e-14  1.30e-01\n    66  131  1.789e+01  6.16e-15  4.33e-15  4.4e-15  1.8e+12  5.0e-15  1.31e-01\n    67  133  1.789e+01  8.54e-15  8.66e-15  8.7e-15  2.3e+11  1.0e-14  1.36e-01\n    68  134  1.789e+01 -5.59e+08  1.73e-14  1.7e-14  4.5e+11  2.0e-14  1.29e-01\n\n ***** FALSE CONVERGENCE *****\n\n FUNCTION     1.788786e+01   RELDX        1.746e-14\n FUNC. EVALS     134         GRAD. EVALS      68\n PRELDF       1.732e-14      NPRELDF      1.288e-01\n\n     I      FINAL X(I)        D(I)          G(I)\n\n     1    1.835300e-02     1.000e+00    -3.499e+00\n     2    1.728230e-16     1.000e+00     5.063e+00\n     3    1.135831e-01     1.000e+00     1.355e+01\n     4    3.368745e-01     1.000e+00    -2.752e+00\n     5    5.099761e-01     1.000e+00    -2.577e+00\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(g1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\ngarch(x = garch11.sim, order = c(2, 2))\n\nModel:\nGARCH(2,2)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-3.346827 -0.631881  0.008473  0.736112  3.202344 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)  \na0 1.835e-02   1.515e-02    1.211   0.2257  \na1 1.728e-16   4.723e-02    0.000   1.0000  \na2 1.136e-01   5.855e-02    1.940   0.0524 .\nb1 3.369e-01   3.696e-01    0.911   0.3621  \nb2 5.100e-01   3.575e-01    1.426   0.1538  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 0.41859, df = 2, p-value = 0.8112\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 0.005298, df = 1, p-value = 0.942\n```\n\n\n:::\n\n```{.r .cell-code}\ng2 <- garch(garch11.sim,order=c(1,1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n ***** ESTIMATION WITH ANALYTICAL GRADIENT ***** \n\n     I     INITIAL X(I)        D(I)\n\n     1     3.706160e-01     1.000e+00\n     2     5.000000e-02     1.000e+00\n     3     5.000000e-02     1.000e+00\n\n    IT   NF      F         RELDF    PRELDF    RELDX   STPPAR   D*STEP   NPRELDF\n     0    1  2.773e+01\n     1    5  2.773e+01  2.16e-04  4.35e-04  4.2e-03  7.0e+02  4.2e-03  1.52e-01\n     2    6  2.772e+01  2.97e-04  3.53e-04  5.2e-03  2.0e+00  4.2e-03  2.85e-01\n     3    7  2.770e+01  5.63e-04  6.26e-04  8.8e-03  2.0e+00  8.3e-03  1.97e-01\n     4   11  2.652e+01  4.27e-02  1.90e-02  3.8e-01  9.4e-01  2.7e-01  1.56e-01\n     5   12  2.385e+01  1.01e-01  1.53e-01  4.4e-01  2.0e+00  5.3e-01  4.52e+01\n     6   15  2.356e+01  1.24e-02  1.10e-01  6.4e-03  1.3e+01  1.0e-02  3.35e+00\n     7   16  2.290e+01  2.81e-02  2.74e-02  6.5e-03  2.0e+00  1.0e-02  9.28e+00\n     8   18  2.060e+01  1.00e-01  1.90e-01  4.7e-02  6.2e+00  7.5e-02  1.05e+00\n     9   20  1.952e+01  5.22e-02  4.29e-02  3.5e-02  2.0e+00  5.9e-02  5.80e+00\n    10   22  1.809e+01  7.32e-02  8.53e-02  6.2e-02  2.0e+00  1.2e-01  3.74e+01\n    11   26  1.785e+01  1.32e-02  2.55e-02  7.9e-04  3.4e+00  1.7e-03  1.17e+01\n    12   30  1.765e+01  1.13e-02  1.15e-02  6.9e-03  2.0e+00  1.4e-02  9.52e+00\n    13   31  1.746e+01  1.08e-02  2.06e-02  1.4e-02  2.0e+00  2.8e-02  1.10e+00\n    14   34  1.744e+01  9.37e-04  2.19e-03  1.4e-04  1.1e+01  2.8e-04  1.37e-01\n    15   35  1.744e+01  1.00e-04  1.03e-04  1.4e-04  2.0e+00  2.8e-04  3.18e-02\n    16   36  1.744e+01  7.34e-05  9.97e-05  2.7e-04  2.0e+00  5.6e-04  2.24e-02\n    17   37  1.743e+01  2.06e-04  3.04e-04  5.1e-04  2.0e+00  1.1e-03  1.40e-02\n    18   38  1.743e+01  1.16e-04  1.59e-04  4.8e-04  1.9e+00  1.1e-03  3.80e-03\n    19   39  1.743e+01  4.11e-05  7.69e-05  5.1e-04  1.3e+00  1.1e-03  2.31e-04\n    20   40  1.743e+01  8.47e-06  1.29e-05  1.3e-04  0.0e+00  3.0e-04  1.29e-05\n    21   41  1.743e+01  2.90e-06  1.57e-05  9.8e-05  0.0e+00  2.4e-04  1.57e-05\n    22   42  1.743e+01  7.81e-07  7.47e-07  9.0e-06  0.0e+00  2.1e-05  7.47e-07\n    23   43  1.743e+01  2.69e-07  4.49e-08  1.6e-06  0.0e+00  4.1e-06  4.49e-08\n    24   44  1.743e+01 -2.34e-08  5.16e-11  1.9e-07  0.0e+00  4.6e-07  5.16e-11\n\n ***** RELATIVE FUNCTION CONVERGENCE *****\n\n FUNCTION     1.743183e+01   RELDX        1.897e-07\n FUNC. EVALS      44         GRAD. EVALS      24\n PRELDF       5.158e-11      NPRELDF      5.158e-11\n\n     I      FINAL X(I)        D(I)          G(I)\n\n     1    7.574525e-03     1.000e+00     9.582e-03\n     2    4.718358e-02     1.000e+00    -5.087e-04\n     3    9.353769e-01     1.000e+00     9.737e-04\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(g2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\ngarch(x = garch11.sim, order = c(1, 1))\n\nModel:\nGARCH(1,1)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-3.307030 -0.637977  0.009156  0.741977  3.019441 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)    \na0  0.007575    0.007590    0.998   0.3183    \na1  0.047184    0.022308    2.115   0.0344 *  \nb1  0.935377    0.035839   26.100   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 0.82911, df = 2, p-value = 0.6606\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 0.53659, df = 1, p-value = 0.4638\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm1=garch(x=r.cref,order=c(1,1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n ***** ESTIMATION WITH ANALYTICAL GRADIENT ***** \n\n     I     INITIAL X(I)        D(I)\n\n     1     3.744782e-01     1.000e+00\n     2     5.000000e-02     1.000e+00\n     3     5.000000e-02     1.000e+00\n\n    IT   NF      F         RELDF    PRELDF    RELDX   STPPAR   D*STEP   NPRELDF\n     0    1  3.221e+01\n     1    4  3.210e+01  3.24e-03  4.13e-03  9.8e-03  1.3e+03  1.0e-02  2.74e+00\n     2    6  3.201e+01  2.94e-03  6.22e-03  2.6e-02  3.4e+02  2.0e-02  3.50e+00\n     3    7  3.199e+01  6.93e-04  2.39e-03  2.6e-02  1.9e+00  2.0e-02  1.17e-02\n     4    8  3.194e+01  1.41e-03  1.29e-03  2.2e-02  1.9e+00  2.0e-02  8.47e-03\n     5   12  2.932e+01  8.20e-02  1.41e-02  7.6e-01  0.0e+00  6.4e-01  1.79e-02\n     6   14  2.612e+01  1.09e-01  5.98e-02  8.2e-02  2.0e+00  1.3e-01  5.17e+01\n     7   16  2.593e+01  7.50e-03  4.26e-02  1.6e-02  2.0e+00  2.6e-02  1.15e+04\n     8   17  2.518e+01  2.89e-02  3.40e-02  1.3e-02  2.0e+00  2.6e-02  3.98e+03\n     9   19  2.512e+01  2.48e-03  5.40e-03  5.7e-03  2.0e+00  9.9e-03  3.35e+02\n    10   20  2.504e+01  3.15e-03  3.76e-03  5.4e-03  2.0e+00  9.9e-03  7.80e-01\n    11   21  2.483e+01  8.37e-03  1.32e-02  1.1e-02  2.0e+00  2.0e-02  1.47e+02\n    12   23  2.447e+01  1.42e-02  2.22e-02  8.4e-03  2.0e+00  1.7e-02  1.37e+03\n    13   24  2.446e+01  4.63e-04  5.05e-03  9.0e-03  2.0e+00  1.7e-02  5.17e+00\n    14   25  2.442e+01  1.63e-03  7.22e-03  3.6e-03  2.0e+00  8.6e-03  1.94e+02\n    15   26  2.410e+01  1.34e-02  1.50e-02  4.9e-03  2.0e+00  8.6e-03  8.93e+02\n    16   27  2.398e+01  4.73e-03  5.46e-03  4.4e-03  2.0e+00  8.6e-03  5.30e+02\n    17   29  2.395e+01  1.12e-03  4.00e-03  3.6e-03  2.0e+00  6.5e-03  1.05e+02\n    18   30  2.391e+01  1.72e-03  3.84e-03  3.1e-03  2.0e+00  6.5e-03  5.76e+00\n    19   31  2.386e+01  2.40e-03  2.98e-03  3.2e-03  2.0e+00  6.5e-03  6.55e+00\n    20   32  2.377e+01  3.76e-03  4.09e-03  6.6e-03  2.0e+00  1.3e-02  1.88e-01\n    21   35  2.373e+01  1.34e-03  3.22e-03  5.7e-04  2.3e+00  1.1e-03  2.23e-01\n    22   36  2.370e+01  1.65e-03  1.71e-03  5.3e-04  2.0e+00  1.1e-03  9.28e+00\n    23   37  2.366e+01  1.35e-03  1.77e-03  8.2e-04  2.0e+00  2.2e-03  4.07e+00\n    24   38  2.365e+01  6.20e-04  1.88e-03  2.4e-03  2.0e+00  4.3e-03  2.06e-01\n    25   39  2.361e+01  1.73e-03  1.73e-03  2.3e-03  2.0e+00  4.3e-03  1.72e+00\n    26   41  2.359e+01  7.23e-04  1.74e-03  1.6e-03  2.0e+00  3.6e-03  1.14e+00\n    27   42  2.355e+01  1.70e-03  2.69e-03  3.6e-03  2.0e+00  7.1e-03  8.97e-02\n    28   43  2.345e+01  4.12e-03  4.71e-03  3.7e-03  2.1e+00  7.1e-03  8.91e-01\n    29   44  2.334e+01  4.99e-03  6.54e-03  7.3e-03  2.0e+00  1.4e-02  4.65e-01\n    30   46  2.329e+01  2.11e-03  2.64e-03  1.5e-03  5.5e+00  2.9e-03  2.96e-02\n    31   49  2.328e+01  1.49e-04  2.61e-04  9.1e-05  5.6e+00  1.8e-04  1.32e+00\n    32   50  2.328e+01  7.36e-05  7.65e-05  9.7e-05  2.9e+00  1.8e-04  7.34e-01\n    33   51  2.328e+01  1.49e-04  1.55e-04  1.7e-04  2.0e+00  3.7e-04  6.83e-01\n    34   55  2.323e+01  2.02e-03  3.49e-03  4.3e-03  2.0e+00  9.3e-03  5.61e-01\n    35   59  2.323e+01  1.39e-04  2.41e-04  7.3e-05  5.1e+00  1.5e-04  2.64e-03\n    36   60  2.323e+01  1.12e-05  1.37e-05  7.1e-05  1.9e+00  1.5e-04  4.98e-04\n    37   63  2.323e+01  1.20e-04  1.67e-04  9.3e-04  9.8e-01  1.9e-03  4.28e-04\n    38   64  2.323e+01  1.90e-05  4.79e-05  9.5e-04  0.0e+00  1.9e-03  4.79e-05\n    39   65  2.323e+01  4.43e-06  1.61e-06  6.2e-05  0.0e+00  1.5e-04  1.61e-06\n    40   81  2.323e+01 -6.12e-16  2.77e-16  2.1e-14  4.9e+08  4.1e-14  9.63e-08\n\n ***** FALSE CONVERGENCE *****\n\n FUNCTION     2.322510e+01   RELDX        2.067e-14\n FUNC. EVALS      81         GRAD. EVALS      40\n PRELDF       2.771e-16      NPRELDF      9.635e-08\n\n     I      FINAL X(I)        D(I)          G(I)\n\n     1    1.632722e-02     1.000e+00     4.747e-02\n     2    4.414103e-02     1.000e+00    -1.480e-01\n     3    9.170401e-01     1.000e+00    -3.126e-02\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\ngarch(x = r.cref, order = c(1, 1))\n\nModel:\nGARCH(1,1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.78577 -0.61949  0.08695  0.67933  3.30810 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)    \na0   0.01633     0.01237    1.320   0.1869    \na1   0.04414     0.02097    2.105   0.0353 *  \nb1   0.91704     0.04570   20.066   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 1.0875, df = 2, p-value = 0.5806\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 0.77654, df = 1, p-value = 0.3782\n```\n\n\n:::\n:::\n\n\n\n\n## Diagnostics of the model\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(residuals(m1),type='h',ylab='Standardized Residuals')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(m1), main=\"Normal Q-Q Plot of Residuals\") \nqqline(residuals(m1))\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(residuals(m1)^2,na.action=na.omit, main=\"ACF of Squared Residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(abs(residuals(m1)),na.action=na.omit, main=\"ACF of Absolute Residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n:::\n\n\n\n\nWe do not detect significant ARCH effects in the residuals. Thus the model is fitted adequately.\n\n<!-- \n\n## Example of ARCH(p) model: US GNP data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"astsa\", repos = \"http://cran.us.r-project.org\")\n#install.packages(\"fGarch\", repos = \"http://cran.us.r-project.org\")\n\nlibrary(fGarch)\nset.seed(123)\n\n# Simulate ARCH(1) process, the formula will be sigma^2 = alpha_0 + alpha_1 * e^2_{t-1}, where alpha_0 = 5, alpha_1 = 0.5\narch_sim <- as.ts(garchSim(spec = garchSpec(model = list(alpha = c(0.1, 0.8), beta = 0)), n = 300))\n\narch_sim2 <- as.ts(garchSim(spec = garchSpec(model = list(alpha = c(0.1, 0.7, 0.1), beta = 0)), n = 300))\n\nplot(arch_sim, type = \"l\", main = \"Simulated ARCH(1) process\", ylab = \"Value\", xlab = \"Time\", col = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(arch_sim2, type = \"l\", main = \"Simulated ARCH(2) process\", ylab = \"Value\", xlab = \"Time\", col = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(arch_sim, main = \"Normal Q-Q plot of ARCH(1) residuals\")\nqqline(arch_sim, col = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(arch_sim2, main = \"Normal Q-Q plot of ARCH(2) residuals\")\nqqline(arch_sim2, col = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(arch_sim, main = \"ACF of ARCH(1)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-5.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(arch_sim2, main = \"ACF of ARCH(2)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-6.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(arch_sim^2, main = \"ACF of Squared ARCH(1)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-7.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(arch_sim^2, main = \"PACF of Squared ARCH(1)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-8.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(arch_sim2^2, main = \"ACF of Squared ARCH(2)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-9.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(arch_sim2^2, main = \"PACF of Squared ARCH(2)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-10.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(abs(arch_sim), main = \"ACF of Squared ARCH(1)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-11.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(abs(arch_sim), main = \"PACF of Squared ARCH(1)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-12.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(abs(arch_sim2), main = \"ACF of Squared ARCH(2)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-13.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(abs(arch_sim2), main = \"PACF of Squared ARCH(2)\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-11-14.png){width=672}\n:::\n:::\n\n\n\n\nBased on the diagnostics, we can see that the residuals are not normally distributed. The Q-Q plot shows that the residuals deviate are heavy tailed. This suggests that maybe ARCH/GARCH model is more appropriate for this data.\n\nAnalyzing the squared residuals can help us identify the presence of ARCH effects. If the squared residuals show significant autocorrelation, it indicates that the variance is not constant over time.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(astsa)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'astsa' was built under R version 4.4.2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(fGarch)\n\ntsplot(GNP, main = \"US GNP data\", ylab = \"GNP\", xlab = \"Time\", col = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\ntsplot(diff(log(GNP)), main = \"US GNP data\", ylab = \"GNP\", xlab = \"Time\", col = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(diff(log(GNP)), xaxp = c(0, 20, 20), main = \"ACF of diff(log(GNP)) data\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(diff(log(GNP)), xaxp = c(0, 20, 20), main = \"PACF of diff(log(GNP)) data\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(TSA)\neacf(diff(log(GNP)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAR/MA\n  0 1 2 3 4 5 6 7 8 9 10 11 12 13\n0 x x o o o o o o x x x  o  o  o \n1 x x o o o o o o o o o  o  o  o \n2 o x o o o o o o o o o  o  o  o \n3 x x x o o o o o o o o  o  o  o \n4 x x o o o o o o o o o  o  o  o \n5 x x x o o o o o o o o  o  o  o \n6 x x x o o o o o o o o  o  o  o \n7 x x o x x o x o o o o  o  o  o \n```\n\n\n:::\n\n```{.r .cell-code}\nar2.fit <- arima(diff(log(GNP)), order = c(2, 0, 0), include.mean = TRUE)\nar2.fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\narima(x = diff(log(GNP)), order = c(2, 0, 0), include.mean = TRUE)\n\nCoefficients:\n         ar1     ar2  intercept\n      0.1818  0.2207     0.0154\ns.e.  0.0559  0.0558     0.0012\n\nsigma^2 estimated as 0.0001573:  log likelihood = 896.69,  aic = -1787.39\n```\n\n\n:::\n\n```{.r .cell-code}\ntsdiag(ar2.fit, main = \"AR(2) model diagnostics\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-5.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(resid(ar2.fit), main = \"Normal Q-Q plot of residuals\")\nqqline(resid(ar2.fit), col = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-6.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(resid(ar2.fit), breaks = 20, main = \"Histogram of residuals\", xlab = \"Residuals\", col = \"lightblue\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-7.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(resid(ar2.fit)^2, main = \"ACF of squared residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-8.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(resid(ar2.fit)^2, main = \"PACF of squared residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-9.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(abs(resid(ar2.fit)), main = \"ACF of abs residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-10.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(abs(resid(ar2.fit)), main = \"PACF of abs residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-12-11.png){width=672}\n:::\n\n```{.r .cell-code}\n#library(TSA)\n#eacf(abs(resid(ar2.fit)))\n\n#eacf((resid(ar2.fit))^2)\n```\n:::\n\n\n\n\n\nThe suggested model is non-normal AR(2)-GARCH(0,1) model. \n\n\\begin{align*}\nY_t &= \\mu_t + \\sigma_t e_t \\\\\n\\mu_t &= \\phi_0 + \\phi_1 Y_{t-1} + \\phi_2 Y_{t-2} \\\\\n\\sigma^2_t &= \\alpha_0 + \\alpha_1 Y^2_{t-1} \\\\\n\\end{align*}\n\nwhere $e_t$ is the error term.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngnp.g <- garchFit(~arma(0,2)+garch(2,0),data=diff(log(GNP)), cond.dist=\"std\", trace=F)\nsummary(gnp.g)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nTitle:\n GARCH Modelling \n\nCall:\n garchFit(formula = ~arma(0, 2) + garch(2, 0), data = diff(log(GNP)), \n    cond.dist = \"std\", trace = F) \n\nMean and Variance Equation:\n data ~ arma(0, 2) + garch(2, 0)\n<environment: 0x0000021e1d2957e0>\n [data = diff(log(GNP))]\n\nConditional Distribution:\n std \n\nCoefficient(s):\n        mu         ma1         ma2       omega      alpha1      alpha2  \n0.01450428  0.29981042  0.34097433  0.00005769  0.68223262  0.14070871  \n     shape  \n3.22371867  \n\nStd. Errors:\n based on Hessian \n\nError Analysis:\n        Estimate  Std. Error  t value Pr(>|t|)    \nmu     1.450e-02   6.679e-04   21.717  < 2e-16 ***\nma1    2.998e-01   6.503e-02    4.610 4.02e-06 ***\nma2    3.410e-01   3.746e-02    9.103  < 2e-16 ***\nomega  5.769e-05   1.799e-05    3.206  0.00135 ** \nalpha1 6.822e-01   2.845e-01    2.398  0.01649 *  \nalpha2 1.407e-01   1.210e-01    1.162  0.24506    \nshape  3.224e+00   6.685e-01    4.822 1.42e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLog Likelihood:\n 1001.915    normalized:  3.306651 \n\nDescription:\n Wed Nov  5 10:30:58 2025 by user: skushna1 \n\n\nStandardised Residuals Tests:\n                                  Statistic      p-Value\n Jarque-Bera Test   R    Chi^2  700.0350033 0.000000e+00\n Shapiro-Wilk Test  R    W        0.9147853 4.282247e-12\n Ljung-Box Test     R    Q(10)   33.6246642 2.137696e-04\n Ljung-Box Test     R    Q(15)   38.8627133 6.718217e-04\n Ljung-Box Test     R    Q(20)   60.7026503 5.541191e-06\n Ljung-Box Test     R^2  Q(10)    1.4238154 9.991536e-01\n Ljung-Box Test     R^2  Q(15)    2.0752817 9.999621e-01\n Ljung-Box Test     R^2  Q(20)    3.0622150 9.999951e-01\n LM Arch Test       R    TR^2     1.7031131 9.997433e-01\n\nInformation Criterion Statistics:\n      AIC       BIC       SIC      HQIC \n-6.567098 -6.481302 -6.568133 -6.532773 \n```\n\n\n:::\n\n```{.r .cell-code}\ngnp.g@fit$ics[\"AIC\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      AIC \n-6.567098 \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(residuals(gnp.g, standardize = TRUE), breaks = 20, main = \"Histogram of residuals\", xlab = \"Residuals\", col = \"lightblue\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(residuals(gnp.g, standardize = TRUE), main = \"ACF of residuals\")    \n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(residuals(gnp.g, standardize = TRUE), main = \"PACF of residuals\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture23-arch-garch_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fGarch)\n\n# Define candidate orders\narma_orders <- list(c(0, 1), c(0, 2), c(1, 1),c(1, 0), c(2, 0), c(2, 1))\ngarch_orders <- list(c(1, 0), c(2, 0), c(1, 1))\n\n# Create a data frame to store results\nresults <- data.frame(\n  arma = character(),\n  garch = character(),\n  AIC = numeric(),\n  stringsAsFactors = FALSE\n)\n\n# Loop over all combinations\nfor (arma in arma_orders) {\n  for (garch in garch_orders) {\n    formula_str <- paste0(\"~arma(\", arma[1], \",\", arma[2], \n                          \")+garch(\", garch[1], \",\", garch[2], \")\")\n    cat(\"Fitting:\", formula_str, \"\\n\")\n    \n    # Fit the model\n    fit <- try(garchFit(as.formula(formula_str), \n                        data = diff(log(GNP)), \n                        cond.dist = \"std\", \n                        trace = FALSE), silent = TRUE)\n    \n    # If successful, store AIC\n    if (!inherits(fit, \"try-error\")) {\n      aic <- fit@fit$ics[\"AIC\"]\n      results <- rbind(results, data.frame(\n        arma = paste0(\"(\", arma[1], \",\", arma[2], \")\"),\n        garch = paste0(\"(\", garch[1], \",\", garch[2], \")\"),\n        AIC = aic\n      ))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFitting: ~arma(0,1)+garch(1,0) \nFitting: ~arma(0,1)+garch(2,0) \nFitting: ~arma(0,1)+garch(1,1) \nFitting: ~arma(0,2)+garch(1,0) \nFitting: ~arma(0,2)+garch(2,0) \nFitting: ~arma(0,2)+garch(1,1) \nFitting: ~arma(1,1)+garch(1,0) \nFitting: ~arma(1,1)+garch(2,0) \nFitting: ~arma(1,1)+garch(1,1) \nFitting: ~arma(1,0)+garch(1,0) \nFitting: ~arma(1,0)+garch(2,0) \nFitting: ~arma(1,0)+garch(1,1) \nFitting: ~arma(2,0)+garch(1,0) \nFitting: ~arma(2,0)+garch(2,0) \nFitting: ~arma(2,0)+garch(1,1) \nFitting: ~arma(2,1)+garch(1,0) \nFitting: ~arma(2,1)+garch(2,0) \nFitting: ~arma(2,1)+garch(1,1) \n```\n\n\n:::\n\n```{.r .cell-code}\n# Show results\nresults[order(results$AIC), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       arma garch       AIC\nAIC17 (2,1) (1,1) -6.605394\nAIC14 (2,0) (1,1) -6.602400\nAIC12 (2,0) (1,0) -6.593980\nAIC15 (2,1) (1,0) -6.589150\nAIC16 (2,1) (2,0) -6.588032\nAIC13 (2,0) (2,0) -6.586102\nAIC5  (0,2) (1,1) -6.583807\nAIC8  (1,1) (1,1) -6.576307\nAIC4  (0,2) (2,0) -6.567098\nAIC7  (1,1) (2,0) -6.561182\nAIC3  (0,2) (1,0) -6.560007\nAIC6  (1,1) (1,0) -6.555569\nAIC11 (1,0) (1,1) -6.546680\nAIC10 (1,0) (2,0) -6.531920\nAIC9  (1,0) (1,0) -6.516024\nAIC2  (0,1) (1,1) -6.454052\nAIC1  (0,1) (2,0) -6.435563\nAIC   (0,1) (1,0) -6.393737\n```\n\n\n:::\n:::\n\n\n\n -->\n",
    "supporting": [
      "TSA-Lecture23-arch-garch_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}