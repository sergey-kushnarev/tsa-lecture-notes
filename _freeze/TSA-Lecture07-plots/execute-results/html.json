{
  "hash": "d88fd6f8f175af0643938c7ce4bf3696",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 7 R notebook: Time Series Plots\"\nauthor: \"Dr Sergey Kushnarev\"\nformat:\n  html:\n    toc: true\n    number-sections: true\n    code-fold: true\n---\n\n\n\n\nThis R notebook is based on a book by Cryer and Chen, \"Time Series Analysis: With Applications in R\" (2nd edition).\nWe will reproduce some of the plots from the Chapters 1 and 4.\nThese will cover the following topics:\n\n- Time series plots\n- Lag plots\n- Random walk\n- ACF and time series plots for: MA(1), MA(2), AR(1), AR(2), ARMA(1,1) \n\n\n## Los Angeles Annual Rainfall\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"TSA\")\nlibrary(TSA)\ndata(larain)\nplot(larain, type = \"o\", col = \"blue\", xlab = \"Year\", ylab = \"Rainfall (inches)\", \n     main = \"Annual Rainfall in Los Angeles\")\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plot\nplot(y=larain,\n     x=zlag(larain),\n     ylab='Inches',\n     xlab='Previous Year Inches',\n     col = 'blue',\n     main='Lag Plot of Annual Rainfall in Los Angeles')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n## Color Property from Chemical Process\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(color)\nplot(color,\n     ylab='Color Property',\n     xlab='Batch',\n     type='o',\n     main='Color Property from Chemical Process',\n     col = 'blue')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plot\nplot(y=color,\n     x=zlag(color),\n     ylab='Color Property',\n     xlab='Previous Batch Color Property', \n     col = 'blue',\n     main='Lag Plot of Color Property from Chemical Process')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n## Hare Abundance in Canada\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(hare)\nplot(hare,\n     ylab='Abundance',\n     xlab='Year',\n     type='o', col = 'blue',\n     main='Hare Abundance in Canada')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plot\nplot(y=hare,\n     x=zlag(hare),\n     ylab='Abundance',\n     xlab='Previous Year Abundance', \n     col = 'blue',\n     main='Lag Plot of Hare Abundance in Canada')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n## Average Monthly Temperatures, Dubuque, Iowa\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Average Monthly Temperatures, Dubuque, Iowa\ndata(tempdub) \nplot(tempdub,\n     ylab='Temperature',\n     type='o', \n     col = 'blue',\n     xlab='Month',\n     main='Average Monthly Temperatures, Dubuque, Iowa')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plot\nplot(y=tempdub,\n     x=zlag(tempdub),\n     ylab='Temperature',\n     xlab='Previous Month Temperature', \n     col = 'blue',\n     main='Lag Plot of Average Monthly Temperatures, Dubuque, Iowa')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n## Oil Filter Sales\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(oilfilters) \noilfilters\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec\n1983                               2385 3302 3958 3302 2441 3107\n1984 5862 4536 4625 4492 4486 4005 3744 2546 1954 2285 1778 3222\n1985 5472 5310 1965 3791 3622 3726 3370 2535 1572 2146 2249 1721\n1986 5357 5811 2436 4608 2871 3349 2909 2324 1603 2148 2245 1586\n1987 5332 5787 2886 5475 3843 2537                              \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(oilfilters,\n     type='o',\n     ylab='Sales',\n     xlab='Month',\n     main='Oil Filter Sales',\n     col = 'blue')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(oilfilters,\n     type='l',\n     ylab='Sales', \n     col = 'blue',\n     xlab='Month',\n     main='Oil Filter Sales')\npoints(y=oilfilters,\n      x=time(oilfilters),\n      pch=as.vector(season(oilfilters)),\n      col = 1:4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n:::\n\n\n\n\n## Random Walk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(439)\ndata(rwalk) # rwalk contains a simulated random walk\nrw2 <- cumsum(rnorm(length(rwalk)))\nrw3 <- cumsum(rnorm(length(rwalk)))\n# plot all three series\nplot(rwalk,\n     type='o',\n     ylab='Random Walk', \n     col = 'blue')\npoints(rw2,\n       type='o',\n       ylab='Random Walk', \n       col = 'red')\npoints(rw3,\n       type='o',\n       ylab='Random Walk', \n       col = 'green')\nlegend('topleft',\n       legend=c('rwalk','rw2','rw3'),\n       col=c('blue','red','green'),\n       lty=1)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\n# Chapter 4\n\n## MA(q) processes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag 1 autocorrelation for MA(1) model\ntheta <- seq(-10,10,by=0.1)\nrho1 <- -theta/(1+theta^2)\nplot(theta,rho1,\n     type='l',\n     ylab='rho(1)',\n     xlab='theta',\n     col = 'blue',\n     main='Lag 1 Autocorrelation for MA(1) model')   \n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Lag 1 autocorrelation for MA(1) model\ntheta1 <- theta[theta >= -1 & theta <= 1]\nrho11 <- -theta1/(1+theta1^2)\nplot(theta1,rho11,\n     type='l',\n     ylab='rho(1)',\n     xlab='theta',\n     col = 'blue',\n     main='Lag 1 Autocorrelation for MA(1) model')   \n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time plot of an MA(1) process with theta = -0.9\ndata(ma1.2.s)\nplot(ma1.2.s,\n     ylab=expression(Y[t]),\n     type='o', \n     col = 'blue',\n     xlab='Time',\n     main='MA(1) process with theta = -0.9')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n# Lag plot Yt vs Y_(t-1) for an MA(1) process with theta = -0.9\n# with the lowess smoother\nplot_lag_lowess <- function(ts_data, num_lags, main_title = \"Lag Plots with LOWESS Smoother\") {\n  par(mfrow = c(ceiling(num_lags / 2), 2),  # Arrange plots in a grid\n      mar = c(4, 4, 2, 2),  # Margins: (bottom, left, top, right)\n      oma = c(1, 1, 2, 1),\n      pty = 's')  # Outer margins for better spacing\n\n  for (i in 1:num_lags) {\n    x <- ts_data[1:(length(ts_data) - i)]  # Lagged values\n    y <- ts_data[(i + 1):length(ts_data)]  # Corresponding Y_t values\n\n    # Plot scatter plot\n    plot(x, y, pch = 'o', col = 'blue',\n         #main = paste('Lag Plot Y_t vs Y_(t-', i, ')'),\n         xlab = paste('Y_(t-', i, ')', sep = ''),\n         ylab = 'Y_t',\n         asp = 1)\n\n    # Add LOWESS fitted line\n    lines(lowess(x, y, f = 2/3), col = 'red', lwd = 2)\n\n    # Add main title across all subplots\n     mtext(main_title, outer = TRUE, cex = 1.5, font = 2)\n  }\n # Reset plotting layout and default shape\n  par(mfrow = c(1, 1), pty = \"m\")\n}\n\nplot_lag_lowess(ma1.2.s, num_lags = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time plot of an MA(1) process with theta = +0.9\ndata(ma1.1.s)\nplot(ma1.1.s,\n     ylab=expression(Y[t]),\n     type='o', \n     col = 'blue',\n     xlab='Time',\n     main='MA(1) process with theta = +0.9')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 2, 0))\n# Lag plot Yt vs Y_(t-1) for MA(1) th=+0.9\n# with the lowess smoother\nplot_lag_lowess(ma1.1.s, num_lags = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time Plot of an MA(2) Process with theta1 = 1 and theta2 = -0.6\ndata(ma2.s)\nplot(ma2.s,\n     ylab=expression(Y[t]),\n     type='o',\n     xlab='Time',\n     main='MA(2) process with theta1 = 1 and theta2 = -0.6',\n     col = 'blue')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n\nplot_lag_lowess(ma2.s, num_lags = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Auto-correlation function for several MA(1) and MA(2) models\npar(mfrow = c(2, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n\n# Function to compute theoretical ACF for MA(1) process\ncompute_acf_ma1 <- function(theta, max_lag = 12) {\n  acf_values <- numeric(max_lag + 1)\n  acf_values[1] <- 1  # ACF at lag 0 is always 1\n  acf_values[2] <- -theta / (1 + theta^2)\n\n for (k in 3:(max_lag + 1)) {\n    acf_values[k] <- 0\n  }\n  return(acf_values)  # Include lag 0\n}\n\n# Function to plot ACF\nplot_acf_ma1 <- function(theta, max_lag = 12) {\n  lags <- 0:max_lag\n  acf_values <- compute_acf_ma1(theta, max_lag)\n\n  plot(lags, acf_values, type = \"h\", lwd = 2, ylim = c(-1, 1),\n       xlab = \"Lag\", ylab = expression(rho[k]), main = \"\", axes = FALSE)\n  points(lags, acf_values, pch = 19, cex = 1.5)\n\n  axis(1, at = lags)\n  axis(2, las = 1)\n  abline(h = 0)\n\n  text(max(lags) * 0.7, \n     max(abs(acf_values), na.rm = TRUE) * 0.8, \n     labels = bquote(theta == .(theta)), \n     cex = 1.2)\n\n   # Label zero ACF values\n  zero_lags <- which(acf_values == 0)\n  text(lags[zero_lags], \n       acf_values[zero_lags], \n       labels = \"0\", \n       pos = 3, \n       cex = 0.8)\n}\n\ncompute_acf_ma2 <- function(theta1, theta2, max_lag = 12) {\n  acf_values <- numeric(max_lag + 1)\n  acf_values[1] <- 1  # ACF at lag 0 is always 1\n\n  acf_values[2] <- -theta1 / (1 + theta1^2 + theta2^2)\n  acf_values[3] <- -theta1 * theta2 / (1 + theta1^2 + theta2^2)\n\n  for (k in 4:(max_lag + 1)) {\n    acf_values[k] <- 0\n  }\n  return(acf_values)  # Include lag 0\n}\n\nplot_acf_ma2 <- function(theta1, theta2, max_lag = 12) {\n  lags <- 0:max_lag\n  acf_values <- compute_acf_ma2(theta1, theta2, max_lag)\n\n  plot(lags, acf_values, type = \"h\", lwd = 2, ylim = c(-1, 1),\n       xlab = \"Lag\", ylab = expression(rho[k]), main = \"\", axes = FALSE)\n  points(lags, acf_values, pch = 19)\n\n  axis(1, at = lags)\n  axis(2, las = 1)\n  abline(h = 0)\n\n  label_text <- bquote(theta[1] == .(theta1) ~ \",\" ~ theta[2] == .(theta2))\n\n  text(max(lags) * 0.7, \n      max(abs(acf_values), na.rm = TRUE) * 0.8, \n      labels = label_text, \n      cex = 1.2)\n  # Label zero ACF values\n  zero_lags <- which(acf_values == 0)\n  text(lags[zero_lags], \n       acf_values[zero_lags], \n       labels = \"0\", \n       pos = 3, \n       cex = 0.8)\n}\n\n# Plot for different theta values\nplot_acf_ma1(0.9)\nplot_acf_ma1(-0.9)\nplot_acf_ma2(0.5, 0.25)\nplot_acf_ma2(1.0, -0.25)\n# Main title\nmtext(\"Theoretical ACFs for various MA(1) and MA(2)\", \n      outer = TRUE, \n      cex = 1.8, \n      line = 2, \n      font = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n## AR(p) processes  \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Auto-correlation function for several AR(1) models\npar(mfrow = c(2, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n\n# Function to plot theoretical ACF for AR(1) process\nplot_acf_ar1 <- function(phi, max_lag = 12) {\n  lags <- 0:max_lag\n  acf_values <- phi^lags\n  \n  plot(lags, acf_values, type = \"h\", lwd = 2, ylim = c(-1, 1),\n       xlab = \"Lag\", ylab = expression(rho[k]), main = \"\", axes = FALSE)\n  points(lags, acf_values, pch = 19, cex = 1.5)\n  \n  axis(1, at = lags)\n  axis(2, las = 1)\n  abline(h = 0)\n  \n  text(max_lag * 0.7, \n      max(acf_values) * 0.8, \n      labels = bquote(phi == .(phi)), \n      cex = 1.2)\n  # Label zero ACF values\n  zero_lags <- which(acf_values == 0)\n  if (length(zero_lags) > 0)\n  {\n  text(lags[zero_lags], \n       acf_values[zero_lags], \n       labels = \"0\", \n       pos = 3, \n       cex = 0.8)\n  }\n}\n\n# Plot for different phi values\nplot_acf_ar1(0.9)\nplot_acf_ar1(0.4)\nplot_acf_ar1(-0.8)\nplot_acf_ar1(-0.5)\n# Main title\nmtext(\"Theoretical ACFs for various AR(1) Models\", \n      outer = TRUE, \n      cex = 1.8, \n      line = 2, \n      font = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time plot of an AR(1) process with phi = 0.9\ndata(ar1.s)\nplot(ar1.s,\n     ylab=expression(Y[t]),\n     type='o',\n     xlab='Time',\n     main='AR(1) process with phi = 0.9',\n     col = 'blue')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plots Yt vs Y_(t-k) for an AR(1) process with phi = 0.9\nplot_lag_lowess(ar1.s, num_lags = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Auto-correlation function for several AR(2) models\npar(mfrow = c(2, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n\n# Function to compute theoretical ACF for AR(2) process\ncompute_acf_ar2 <- function(phi1, phi2, max_lag = 12) {\n  acf_values <- numeric(max_lag + 1)\n  acf_values[1] <- 1  # ACF at lag 0 is always 1\n\n  # Solve Yule-Walker equations for first two autocorrelations\n  acf_values[2] <- phi1 / (1 - phi2)\n  acf_values[3] <- (phi2*(1-phi2) + phi1^2) / (1 - phi2)\n\n  # Recursively compute the rest\n  for (k in 4:(max_lag + 1)) {\n    acf_values[k] <- phi1 * acf_values[k - 1] + phi2 * acf_values[k - 2]\n  }\n\n  return(acf_values)  # Include lag 0\n}\n\n# Function to plot ACF\nplot_acf_ar2 <- function(phi1, phi2, max_lag = 12) {\n  lags <- 0:max_lag\n  acf_values <- compute_acf_ar2(phi1, phi2, max_lag)\n\n  plot(lags, acf_values, type = \"h\", lwd = 2, ylim = c(-1, 1),\n       xlab = \"Lag\", ylab = expression(rho[k]), main = \"\", axes = FALSE)\n  points(lags, acf_values, pch = 19)\n\n  axis(1, at = lags)\n  axis(2, las = 1)\n  abline(h = 0)\n\n  label_text <- bquote(phi[1] == .(phi1) ~ \",\" ~ phi[2] == .(phi2))\n\n  text(max(lags) * 0.7, \n      max(acf_values, na.rm = TRUE) * 0.8, \n      labels = label_text, \n      cex = 1.2)\n  # Label zero ACF values\n  zero_lags <- which(acf_values == 0)\n  if (length(zero_lags) > 0)\n  {\n  text(lags[zero_lags], \n       acf_values[zero_lags], \n       labels = \"0\", \n       pos = 3, \n       cex = 0.8)\n  }\n}\n\n# Plot for different phi1 and phi2 values\nplot_acf_ar2(0.5, 0.25)\nplot_acf_ar2(1.0, -0.25)\nplot_acf_ar2(1.5, -0.75)\nplot_acf_ar2(1.0, -0.6)\n# Main title\nmtext(\"Theoretical ACFs for various AR(2) Models\", \n      outer = TRUE, \n      cex = 1.8, \n      line = 2, \n      font = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time plot of an AR(2) process with phi1 = 1.5 and phi2 = -0.75\ndata(ar2.s)\nplot(ar2.s,\n     ylab=expression(Y[t]),\n     type='o',\n     xlab='Time',\n     main='AR(2) process with phi1 = 1.5 and phi2 = -0.75',\n     col = 'blue', \n     xaxt = 'n')\naxis(1, at = seq(0, length(ar2.s), by = 12))\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## ARMA(p,q) processes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ARMA(1,1) process\ndata(arma11.s)\nplot(arma11.s,\n     ylab=expression(Y[t]),\n     type='o',\n     xlab='Time',\n     main='ARMA(1,1) process with phi = 0.6 and theta = -0.3',\n     col = 'blue')\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lag plots Yt vs Y_(t-k) for an ARMA(1,1) process with phi = 0.6 and theta = -0.3\n\nplot_lag_lowess(arma11.s, num_lags = 4)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Auto-correlation function for ARMA(1,1) model\npar(mfrow = c(2, 2), mar = c(4, 4, 2, 2), oma = c(0, 0, 5, 0))\n\n# Function to compute theoretical ACF for ARMA(1,1) process\ncompute_acf_arma11 <- function(phi, theta, max_lag = 12) {\n  acf_values <- numeric(max_lag + 1)\n  acf_values[1] <- 1  # ACF at lag 0 is always 1\n\n\n  # Recursively compute the rest\n  for (k in 2:(max_lag + 1)) {\n    acf_values[k] <- (1-theta*phi)*(phi-theta)*phi^(k-1)/(1-2*theta*phi+theta^2)\n  }\n\n  return(acf_values)  # Include lag 0\n}\n\n# Function to plot ACF\nplot_acf_arma11 <- function(phi, theta, max_lag = 12) {\n  lags <- 0:max_lag\n  acf_values <- compute_acf_arma11(phi, theta, max_lag)\n\n  plot(lags, acf_values, type = \"h\", lwd = 2, ylim = c(-1, 1),\n       xlab = \"Lag\", ylab = expression(rho[k]), main = \"\", axes = FALSE)\n  points(lags, acf_values, pch = 19)\n\n  axis(1, at = lags)\n  axis(2, las = 1)\n  abline(h = 0)\n\n  label_text <- bquote(phi == .(phi) ~ \",\" ~ theta == .(theta))\n\n  text(max(lags) * 0.7, \n      max(acf_values, na.rm = TRUE) * 0.8, \n      labels = label_text, \n      cex = 1.2)\n\n  # Label zero ACF values\n  zero_lags <- which(acf_values == 0)\n  if (length(zero_lags) > 0)\n  {\n  text(lags[zero_lags], \n       acf_values[zero_lags], \n       labels = \"0\", \n       pos = 3, \n       cex = 0.8)\n  }\n}\n\n# Plot for different phi and theta values\nplot_acf_arma11(0.6, -0.3)\nplot_acf_arma11(-0.6, 0.3)\nplot_acf_arma11(0.6, 0.3)\nplot_acf_arma11(-0.6, -0.3)\n# Main title\nmtext(\"Theoretical ACFs for various ARMA(1,1) Models\", \n      outer = TRUE, \n      cex = 1.8, \n      line = 2, \n      font = 2)\n```\n\n::: {.cell-output-display}\n![](TSA-Lecture07-plots_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "TSA-Lecture07-plots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}